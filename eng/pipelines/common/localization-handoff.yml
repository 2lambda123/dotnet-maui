stages:
  - stage: localization_handoff
    displayName: Localization Handoff
    dependsOn: []
    # condition: and(succeeded(), eq(variables.isLocHandoffBranch, true))

    jobs:
      - job : generate_lci
        displayName: 'Process outgoing strings'
        pool:  $(HostedWinVS2019)
        steps:

          # - task: cesve.one-loc-build.one-loc-build.OneLocBuild@2
          #   displayName: 'Localization Build'
          #   env:
          #     SYSTEM_ACCESSTOKEN: $(System.AccessToken) 
          #   inputs:
          #     locProj: 'eng/automation/LocProject.json'
          #     outDir: '$(Build.ArtifactStagingDirectory)'
          #     packageSourceAuth: patAuth
          #     patVariable: "$(AzDO.OneLocBuildToken)"
          #     gitHubPatVariable: '$(GitHub.Token)'

          # - ${{ if and( notin( variables['Build.Reason'], 'PullRequest' ), eq( variables['Build.SourceBranch'], 'refs/heads/main' ) ) }}:
          - template: /eng/common/templates-official/job/onelocbuild.yml@self
            parameters:
              # LclSource: lclFilesfromPackage
              # LclPackageId: 'LCL-JUNO-PROD-XCSYNC'
              LclSource: lclFilesInRepo
              # SkipLocProjectJsonGeneration: true
              # MirrorRepo: xcsync
              # MirrorBranch: main

          - task: PublishBuildArtifacts@1
            inputs:
              PathtoPublish: '$(Build.ArtifactStagingDirectory)'
              ArtifactName: 'drop'
              publishLocation: 'Container'