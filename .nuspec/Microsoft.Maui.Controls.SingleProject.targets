<!-- "Single Project" support -->
<Project>
  <PropertyGroup Condition=" '$(SingleProject)' == 'true' ">

    <PlatformsProjectFolder Condition=" '$(PlatformsProjectFolder)' == '' ">Platforms\</PlatformsProjectFolder>

    <!-- Android -->
    <EnableDefaultAndroidItems>false</EnableDefaultAndroidItems>
    <AndroidProjectFolder Condition=" '$(AndroidProjectFolder)' == '' ">$(PlatformsProjectFolder)Android\</AndroidProjectFolder>
    <AndroidManifest Condition="Exists('$(AndroidProjectFolder)AndroidManifest.xml')">$(AndroidProjectFolder)AndroidManifest.xml</AndroidManifest>
    <MonoAndroidResourcePrefix>$(AndroidProjectFolder)Resources</MonoAndroidResourcePrefix>
    <MonoAndroidAssetsPrefix>$(AndroidProjectFolder)Assets</MonoAndroidAssetsPrefix>

    <!-- iOS -->
    <EnableDefaultiOSItems>false</EnableDefaultiOSItems>
    <iOSProjectFolder Condition=" '$(iOSProjectFolder)' == '' ">$(PlatformsProjectFolder)\iOS\</iOSProjectFolder>
    <IPhoneResourcePrefix Condition=" '$([MSBuild]::GetTargetPlatformIdentifier($(TargetFramework)))' == 'ios' ">$(iOSProjectFolder)Resources</IPhoneResourcePrefix>
    <_SingleProjectiOSExcludes>$(iOSProjectFolder)/**/.*/**</_SingleProjectiOSExcludes>

    <!-- MacCatalyst -->
    <EnableDefaultMacCatalystItems>false</EnableDefaultMacCatalystItems>
    <MacCatalystProjectFolder Condition=" '$(MacCatalystProjectFolder)' == '' ">$(PlatformsProjectFolder)\MacCatalyst\</MacCatalystProjectFolder>
    <IPhoneResourcePrefix Condition=" '$([MSBuild]::GetTargetPlatformIdentifier($(TargetFramework)))' == 'maccatalyst' ">$(MacCatalystProjectFolder)Resources</IPhoneResourcePrefix>
    <_SingleProjectMacCatalystExcludes>$(MacCatalystProjectFolder)/**/.*/**</_SingleProjectMacCatalystExcludes>

    <!-- Windows -->
    <WindowsProjectFolder Condition=" '$(WindowsProjectFolder)' == '' ">$(PlatformsProjectFolder)\Windows\</WindowsProjectFolder>
    <ApplicationManifest Condition=" '$([MSBuild]::GetTargetPlatformIdentifier($(TargetFramework)))' == 'windows' and Exists('$(WindowsProjectFolder)app.manifest') ">$(WindowsProjectFolder)app.manifest</ApplicationManifest>
    <PackageManifest Condition=" '$([MSBuild]::GetTargetPlatformIdentifier($(TargetFramework)))' == 'windows' and Exists('$(WindowsProjectFolder)Package.appxmanifest') ">$(WindowsProjectFolder)Package.appxmanifest</PackageManifest>
    <RuntimeIdentifiers Condition=" '$(RuntimeIdentifiers)' == '' and '$([MSBuild]::GetTargetPlatformIdentifier($(TargetFramework)))' == 'windows' ">win10-x86;win10-x64;win10-arm64</RuntimeIdentifiers>
    <EnableDefaultPageItems Condition=" '$([MSBuild]::GetTargetPlatformIdentifier($(TargetFramework)))' == 'windows' ">False</EnableDefaultPageItems>
    <EnableDefaultApplicationDefinition Condition=" '$([MSBuild]::GetTargetPlatformIdentifier($(TargetFramework)))' == 'windows' ">False</EnableDefaultApplicationDefinition>
    <_SingleProjectWindowsExcludes>$(WindowsProjectFolder)/**/.*/**</_SingleProjectWindowsExcludes>

  </PropertyGroup>

  <!-- Removals -->
  <ItemGroup Condition=" '$(EnableDefaultItems)' == 'true' and '$(SingleProject)' == 'true' ">
    <!-- Explicitly include the platform code -->
    <_MauiCompileToAdd
        Condition=" '$(TargetPlatformIdentifier)' == 'android' and '$(AndroidProjectFolder)' != '' "
        Include="$(AndroidProjectFolder)**/*$(DefaultLanguageSourceExtension)" />
    <_MauiCompileToAdd
        Condition=" '$(TargetPlatformIdentifier)' == 'ios' and '$(iOSProjectFolder)' != '' "
        Include="$(iOSProjectFolder)**/*$(DefaultLanguageSourceExtension)" />
    <_MauiCompileToAdd
        Condition=" '$(TargetPlatformIdentifier)' == 'maccatalyst' and '$(MacCatalystProjectFolder)' != '' "
        Include="$(MacCatalystProjectFolder)**/*$(DefaultLanguageSourceExtension)" />
    <_MauiCompileToAdd
        Condition=" '$(TargetPlatformIdentifier)' == 'windows' and '$(WindowsProjectFolder)' != '' "
        Include="$(WindowsProjectFolder)**/*$(DefaultLanguageSourceExtension)" />
    <None Include="$(PlatformsProjectFolder)**/*$(DefaultLanguageSourceExtension)" Exclude="@(_MauiCompileToAdd)" />
    <Compile Remove="$(PlatformsProjectFolder)**/*$(DefaultLanguageSourceExtension)" />
    <Compile Include="@(_MauiCompileToAdd)" />
    <_MauiCompileToAdd Remove="@(_MauiCompileToAdd)" />

    <!-- Remove all Windows (WinUI) XAML Files from the Windows folder -->
    <_MauiXamlToRemove
        Condition="'$(WindowsProjectFolder)' != ''"
        Include="$(WindowsProjectFolder)**/*.xaml" />
    <EmbeddedResource Remove="@(_MauiXamlToRemove)" />
    <MauiXaml Remove="@(_MauiXamlToRemove)" />
    <None Include="@(_MauiXamlToRemove)" />
    <_MauiXamlToRemove Remove="@(_MauiXamlToRemove)" />
  </ItemGroup>

  <!-- IDE capabilities -->
  <ItemGroup Condition=" '$(SingleProject)' == 'true' ">
    <ProjectCapability Include="MauiSingleProject" />
    <ProjectCapability Include="LaunchProfiles" />
  </ItemGroup>
</Project>
